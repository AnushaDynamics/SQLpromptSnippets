{
  "id": "584d6602-84dc-4186-9d35-52ea1dc836db",
  "prefix": "GenerateDropObjectsSpecifiedTypeScripts",
  "description": "Generate Scripts to Drop Specified Type of Objects",
  "body": "/* =========================================================================================================================================\r\n-- Server\t\t: Local Server\r\n-- Database\t\t: USER Database\r\n-- Script\t\t: GenerateDropObjectsSpecifiedTypeScripts\r\n-- Description\t: Generate Scripts to Drop Specified Type of Objects\r\n-- Usage\t\t: Execute the Below Script with Required Types in Cursor Definition \"IN Clause\".\r\n-- History\t\t:\r\n========================================================================================================================================= */\r\nDECLARE @ObjectType VARCHAR(256), @ObjectSchema VARCHAR(256), @ObjectName VARCHAR(256), @ParentObjectSchema VARCHAR(256), @ParentObjectName VARCHAR(256);\r\nDECLARE @SQLcmd NVARCHAR(MAX);\r\n--\r\nDECLARE DropObjectCursor CURSOR FOR\r\nSELECT type_desc AS \"ObjectType\",\r\n\tOBJECT_SCHEMA_NAME(object_id) AS \"ObjectSchema\",\r\n\tOBJECT_NAME(object_id) AS \"ObjectName\",\r\n\tOBJECT_SCHEMA_NAME(parent_object_id) AS \"ParentObjectSchema\",\r\n\tOBJECT_NAME(parent_object_id) AS \"ParentObjectName\"\r\nFROM sys.objects\r\nWHERE type_desc IN \r\n\t(\r\n\t\tN'USER_TABLE', --\r\n\t\t--N'SYSTEM_TABLE', --N'INTERNAL_TABLE',\r\n\t\tN'VIEW', --\r\n\t\tN'PRIMARY_KEY_CONSTRAINT', N'FOREIGN_KEY_CONSTRAINT', --\r\n\t\t--N'DEFAULT_CONSTRAINT', --N'CHECK_CONSTRAINT', --N'UNIQUE_CONSTRAINT',\r\n\t\tN'SQL_SCALAR_FUNCTION', N'SQL_TABLE_VALUED_FUNCTION', --\r\n\t\tN'SQL_STORED_PROCEDURE', --\r\n\t\tN'SQL_TRIGGER'\r\n\t);\r\nOPEN DropObjectCursor;\r\nFETCH NEXT FROM DropObjectCursor INTO @ObjectType, @ObjectSchema, @ObjectName, @ParentObjectSchema, @ParentObjectName;\r\nWHILE @@fetch_status = 0\r\n\tBEGIN\r\n\t\tSELECT @SQLcmd = CASE\r\n\t\t\t\t\t\t\t WHEN @ObjectType IN ( N'USER_TABLE', N'SYSTEM_TABLE', N'INTERNAL_TABLE' ) \r\n\t\t\t\t\t\t\t\tTHEN 'DROP TABLE ' + QUOTENAME(@ObjectSchema) + '.' + QUOTENAME(@ObjectName) + N';'\r\n\t\t\t\t\t\t\t WHEN @ObjectType IN ( N'VIEW' )\r\n\t\t\t\t\t\t\t\tTHEN 'DROP VIEW ' + QUOTENAME(@ObjectSchema) + '.' + QUOTENAME(@ObjectName) + N';'\r\n\t\t\t\t\t\t\t WHEN @ObjectType IN ( N'PRIMARY_KEY_CONSTRAINT', N'FOREIGN_KEY_CONSTRAINT', N'DEFAULT_CONSTRAINT', N'CHECK_CONSTRAINT', N'UNIQUE_CONSTRAINT' )\r\n\t\t\t\t\t\t\t\tTHEN 'ALTER TABLE ' + QUOTENAME(@ParentObjectSchema) + '.' + QUOTENAME(@ParentObjectName) + N' DROP CONSTRAINT ' + QUOTENAME(@ObjectName) + N';'\r\n\t\t\t\t\t\t\t WHEN @ObjectType IN ( N'SQL_SCALAR_FUNCTION', N'SQL_TABLE_VALUED_FUNCTION' )\r\n\t\t\t\t\t\t\t\tTHEN 'DROP FUNCTION ' + QUOTENAME(@ObjectSchema) + '.' + QUOTENAME(@ObjectName) + N';'\r\n\t\t\t\t\t\t\t WHEN @ObjectType IN ( N'SQL_STORED_PROCEDURE' )\r\n\t\t\t\t\t\t\t\tTHEN 'DROP PROCEDURE ' + QUOTENAME(@ObjectSchema) + '.' + QUOTENAME(@ObjectName) + N';'\r\n\t\t\t\t\t\t\t WHEN @ObjectType IN ( N'SQL_TRIGGER' )\r\n\t\t\t\t\t\t\t\tTHEN 'DROP TRIGGER ' + QUOTENAME(@ObjectSchema) + '.' + QUOTENAME(@ObjectName) + N';'\r\n\t\t\t\t\t\t\t ELSE\r\n\t\t\t\t\t\t\t\t NULL\r\n\t\t\t\t\t\t END;\r\n\t\tPRINT @SQLcmd + CHAR(10) + 'GO';\r\n\t\t--EXEC sys.sp_executesql @statement = @SQLcmd;\r\n\t\t--\r\n\t\tFETCH NEXT FROM DropObjectCursor INTO @ObjectType, @ObjectSchema, @ObjectName, @ParentObjectSchema, @ParentObjectName;\r\n\t\t--\r\n\tEND;\r\n\r\nCLOSE DropObjectCursor;\r\nDEALLOCATE DropObjectCursor;\r\n"
}