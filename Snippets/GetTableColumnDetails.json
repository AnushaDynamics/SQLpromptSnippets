{
  "id": "4791ee5c-8513-40fc-b394-a53368b141d3",
  "prefix": "GetTableColumnDetails",
  "description": "Get Table All Column Details",
  "body": "/* =============================================================================================================================================================\r\n-- Server\t\t: LOCAL SERVER\r\n-- Database\t\t: USER DATABASE\r\n-- Script\t\t: GetTableColumnDetails\r\n-- Description\t: Get Details of Columns Along with DataTypes and Properities\r\n============================================================================================================================================================= */\r\nDECLARE @SCHname VARCHAR(128) = '$SchName$'; --Optional\r\nDECLARE @TBLname VARCHAR(128) = '$TblName$'; --Optional\r\n--\r\nSET @SCHname = LTRIM(RTRIM(@SCHname)); IF @SCHname = '' SET @SCHname = NULL;\r\nSET @TBLname = LTRIM(RTRIM(@TBLname)); IF @TBLname = '' SET @TBLname = NULL;\r\n--\r\nSELECT SCH.name AS \"SchemaName\",\r\n\t   TBL.name AS \"TableName\",\r\n\t   COL.column_id AS \"ColID\",\r\n\t   COL.name AS \"ColumnName\",\r\n\t   CASE WHEN COL.user_type_id <> COL.system_type_id THEN TYPE_NAME(COL.user_type_id) ELSE '' END AS \"UserDataType\",\r\n\t   ST.name AS \"SystemDataType\",\r\n\t   COL.max_length AS \"MaxLength\", --This Value Applies Only for DataTypes IN ( 'varbinary', 'varchar', 'binary', 'char', 'nvarchar', 'nchar' )\r\n\t   COL.precision AS \"Precision\", --This Value Applies Only for DataTypes IN ( 'decimal', 'numeric' )\r\n\t   COL.scale AS \"Scale\", --This Value Applies Only for DataTypes IN ( 'decimal', 'numeric' )\r\n\t   ST.name --\r\n\t\t   + CASE\r\n\t\t\t\t WHEN ST.name IN ( 'image', 'text', 'uniqueidentifier', 'date', 'time', 'datetime2', 'datetimeoffset', 'tinyint', 'smallint', 'int', 'smalldatetime', 'real', 'money', 'datetime', 'float', 'sql_variant', 'ntext', 'bit', 'smallmoney', 'bigint', 'timestamp', 'xml' ) THEN ''\r\n\t\t\t\t WHEN ST.name IN ( 'decimal', 'numeric' ) THEN '(' + CAST(COL.precision AS VARCHAR(4)) + ', ' + CAST(COL.scale AS VARCHAR(4)) + ')'\r\n\t\t\t\t WHEN COL.max_length = -1 THEN '(max)'\r\n\t\t\t\t WHEN ST.name IN ( 'nvarchar', 'nchar' ) THEN '(' + CAST(COL.max_length / 2 AS VARCHAR(5)) + ')'\r\n\t\t\t\t WHEN ST.name IN ( 'varchar', 'char', 'varbinary', 'binary' ) THEN '(' + CAST(COL.max_length AS VARCHAR(5)) + ')'\r\n\t\t\t\t ELSE NULL\r\n\t\t\t END AS \"ConfiguredSystemType\",\r\n\t   ISNULL(PKC.Is_PK, 0) AS \"IsPrimaryKeyCol?\",\r\n\t   COL.is_identity AS \"IsIdentityCol?\",\r\n\t   COL.is_computed AS \"IsComputedCol?\"\r\nFROM sys.columns AS COL --UT\r\nINNER JOIN sys.types AS ST ON ST.user_type_id = COL.system_type_id\r\nINNER JOIN sys.tables AS TBL ON TBL.object_id = COL.object_id\r\nINNER JOIN sys.schemas AS SCH ON SCH.schema_id = TBL.schema_id\r\nLEFT JOIN (\r\n\t\t\t  SELECT IC.object_id, IC.column_id, 1 AS \"Is_PK\"\r\n\t\t\t  FROM sys.index_columns AS IC\r\n\t\t\t  INNER JOIN sys.key_constraints AS KC ON IC.object_id = KC.parent_object_id\r\n\t\t\t\t\t AND IC.index_id = KC.unique_index_id AND KC.type = 'PK'\r\n\t\t  ) AS PKC ON PKC.column_id = COL.column_id AND PKC.object_id = COL.object_id\r\nWHERE 1 = 1\r\n\tAND (SCH.name = @SCHname OR @SCHname IS NULL)\r\n\tAND (TBL.name = @TBLname OR @TBLname IS NULL)\r\nORDER BY SCH.name ASC, TBL.name ASC, COL.column_id ASC;",
  "placeholders": [
    {
      "name": "SchName",
      "defaultValue": " "
    },
    {
      "name": "TblName",
      "defaultValue": " "
    }
  ]
}