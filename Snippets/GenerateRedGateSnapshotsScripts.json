{
  "id": "9b127f6d-c87b-4cdb-80af-53b931beea06",
  "prefix": "GenerateRedGateSnapshotsScripts",
  "description": "Generate Commands to Create RedGate Snapshots from Command Line",
  "body": "/* =========================================================================================================================================\r\n-- Server\t\t: SQL Instance\r\n-- Database\t\t: master\r\n-- Script\t\t: GenerateRedGateSnapshotsScripts\r\n-- Description\t: Generate Commands to Create RedGate Snapshots from Command Line\r\n-- Requirement\t: Require Valid License for Redgate Compare Tool\r\n-- Usage\t\t: As Below:\r\n\t\t\t\tNavigate to Folder where Redgate SQLcompare Tool is installed as below\r\n\t\t\t\tcd \"C:\\Program Files (x86)\\Red Gate\\SQL Compare 14\"\r\n\t\t\t\tOpen Command Prompt (Admin not required) and paste the below\r\n\t\t\t\tsqlcompare /s1:SVRname /db1:DBname /makeSnapshot:\"C:\\SQL\\RedgateSnaps\\SVRname_DBname_YYYYMMDD.snp\" /force\r\n\t\t\t*** We need to execute these Commands only where Redgate SQLcompare Tool is installed with Valid License.\r\n========================================================================================================================================= */\r\nUSE master;\r\nGO\r\n--\r\n--Mention the Location of SQLcompare CommandLine Application Path in \"@SQLcompareEXE_Location\"\r\nDECLARE @SQLcompareEXE_Location VARCHAR(255) = 'C:\\Program Files (x86)\\Red Gate\\SQL Compare 14';\r\n--Mention the FolderPath to Store all the Snapshots in the \"@SnapshotLocation\"\r\nDECLARE @SnapshotLocation VARCHAR(255) = 'C:\\SQL\\RedGateSnaps';\r\n\r\n--\r\n/* ===== ** DO NOT CHANGE CODE BELOW FROM HERE ** ======================================================================================= */\r\nSET NOCOUNT ON;\r\n--\r\nSELECT 'cd \"' + @SQLcompareEXE_Location + '\"' AS \"Change Directory where sqlcompare.exe Installed\";\r\n--\r\nSELECT @@SERVERNAME AS \"SVRname\",\r\n\t   name AS \"DBname\",\r\n\t   @@SERVERNAME + '_' + name + '_' + CONVERT(VARCHAR(32), GETDATE(), 112) AS \"SnapName\",\r\n\t   'sqlcompare /s1:' + @@SERVERNAME + ' /db1:' + name + ' /makeSnapshot:\"' + @SnapshotLocation + '\\'\r\n\t   + @@SERVERNAME + '_' + name + '_' + CONVERT(VARCHAR(32), GETDATE(), 112) + '.snp\" /force' AS \"SnapshotCreationCMD\"\r\nFROM sys.databases\r\nWHERE database_id > 4;\r\nGO \r\n--"
}