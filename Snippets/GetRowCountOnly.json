{
  "id": "06c61315-3060-4d71-b426-fa5461e25512",
  "prefix": "GetRowCountOnly",
  "description": "Get Row Count for Each Table",
  "body": "DECLARE @SCHname VARCHAR(128) = NULL; --Optional\r\nDECLARE @TBLname VARCHAR(128) = NULL; --Optional\r\n--\r\nSELECT OBJECT_SCHEMA_NAME(PS.object_id) AS \"SchemaName\", \r\n\t   OBJECT_NAME(PS.object_id) AS \"TableName\", \r\n\t   SUM(CASE WHEN PS.index_id < 2 THEN PS.row_count ELSE 0 END) AS \"Rows\"\r\nFROM sys.dm_db_partition_stats AS PS\r\nWHERE OBJECT_SCHEMA_NAME(PS.object_id) <> 'sys'\t\t\t--To Avoid \"sys\" schema\r\n\tAND OBJECTPROPERTY(PS.object_id, 'IsUserTable') = 1\t--To Consider Only User Created Tables\r\n\tAND (OBJECT_SCHEMA_NAME(PS.object_id) = @SCHname OR @SCHname IS NULL)\r\n\tAND (OBJECT_NAME(PS.object_id) = @TBLname OR @TBLname IS NULL)\r\nGROUP BY PS.object_id\r\n--HAVING SUM(CASE WHEN PS.index_id < 2 THEN PS.row_count ELSE 0 END) > 0\r\nORDER BY [Rows] DESC, SchemaName ASC, TableName ASC;"
}