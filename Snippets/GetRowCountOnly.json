{
  "id": "06c61315-3060-4d71-b426-fa5461e25512",
  "prefix": "GetRowCountOnly",
  "description": "Get Row Count and Size for Each Table",
  "body": "DECLARE @SCHname VARCHAR(128) = $SCHname$; --Optional\r\nDECLARE @TBLname VARCHAR(128) = $TBLname$; --Optional\r\n\r\n--\r\n--$BeginRegion: Get Only Row Counts for Each Table\r\nSELECT OBJECT_SCHEMA_NAME(P.object_id) AS \"SchemaName\",\r\n\t   OBJECT_NAME(P.object_id) AS \"TableName\",\r\n\t   P.rows AS \"Rows\"\r\nFROM sys.partitions AS P\r\nWHERE OBJECT_SCHEMA_NAME(P.object_id) <> 'sys' --To Avoid \"sys\" schema\r\n\t  AND OBJECTPROPERTY(P.object_id, 'IsUserTable') = 1 --To Consider Only User Created Tables\r\n\t  AND (OBJECT_SCHEMA_NAME(P.object_id) = @SCHname OR @SCHname IS NULL)\r\n\t  AND (OBJECT_NAME(P.object_id) = @TBLname OR @TBLname IS NULL)\r\nGROUP BY P.object_id, P.rows --Used as alternative to DISTINCT\r\n--HAVING P.rows > 0 --UnComment To Hide Empty Tables\r\nORDER BY P.rows DESC;\r\n--$EndRegion: Get Only Row Counts for Each Table\r\n\r\n--\r\n--$BeginRegion: Get Row Counts and Size Allocated for Each Table\r\nSELECT OBJECT_SCHEMA_NAME(P.object_id) AS \"SchemaName\",\r\n\t   OBJECT_NAME(P.object_id) AS \"TableName\",\r\n\t   P.rows AS \"Rows\",\r\n\t   CAST(ROUND(((SUM(AU.total_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS \"Reserved(MB)\",\r\n\t   CAST(ROUND(((SUM(AU.used_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS \"Used(MB)\",\r\n\t   CAST(ROUND(((SUM(AU.total_pages) - SUM(AU.used_pages)) * 8) / 1024.00, 2) AS NUMERIC(36, 2)) AS \"UnUsed(MB)\"\r\nFROM sys.partitions AS P\r\nINNER JOIN sys.allocation_units AS AU\r\n\tON P.partition_id = AU.container_id\r\nWHERE OBJECT_SCHEMA_NAME(P.object_id) <> 'sys' --To Avoid \"sys\" schema\r\n\t  AND OBJECTPROPERTY(P.object_id, 'IsUserTable') = 1 --To Consider Only User Created Tables\r\n\t  AND (OBJECT_SCHEMA_NAME(P.object_id) = @SCHname OR @SCHname IS NULL)\r\n\t  AND (OBJECT_NAME(P.object_id) = @TBLname OR @TBLname IS NULL)\r\nGROUP BY P.object_id, P.rows\r\n--HAVING P.rows > 0 --UnComment To Hide Empty Tables\r\nORDER BY SUM(AU.total_pages) DESC, P.rows DESC;\r\n--$EndRegion: Get Row Counts and Size Allocated for Each Table",
  "placeholders": [
    {
      "name": "SCHname",
      "defaultValue": "NULL"
    },
    {
      "name": "TBLname",
      "defaultValue": "NULL"
    }
  ]
}