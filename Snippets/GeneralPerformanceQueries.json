{
  "id": "9d4e127a-4d65-4be0-a4ac-e1fd070ebad3",
  "prefix": "GeneralPerformanceQueries",
  "description": "General Performance Queries to Understand the Performance",
  "body": "--Sample Data Rows Count --Use Snippet \"SampleDataGeneration\" to generate huge data in batches\r\n--SchemaName\tTableName\t\tRows\r\n--dbo\t\t\tEmployeeTbl\t\t2247347\r\n--dbo\t\t\tDepartmentTbl\t14\r\n--dbo\t\t\tProjectTbl\t\t9\r\n--\r\n--$BeginRegion: Scenario #1: Performance Check --Single Query vs Union Query\r\nDBCC DROPCLEANBUFFERS;\r\nDBCC FREEPROCCACHE;\r\nDBCC FREESYSTEMCACHE('ALL');\r\n--\r\nSET STATISTICS IO ON; SET STATISTICS TIME ON;\r\nSELECT ET.EmpID, ET.EmpName, ET.EmpDOB, ET.EmpDOJ, ET.EmpSalary, ET.DeptID, ET.ProjID, ET.Status\r\nFROM dbo.EmployeeTbl AS ET\r\nWHERE (EXISTS (SELECT * FROM dbo.DepartmentTbl AS DT WHERE DT.DeptID=ET.DeptID AND DT.DeptID=4))\r\n\tOR(EXISTS (SELECT * FROM dbo.ProjectTbl AS PT WHERE PT.ProjID=ET.ProjID AND PT.ProjID=3));\r\nSET STATISTICS IO OFF; SET STATISTICS TIME OFF;\r\n--\r\n--\r\nDBCC DROPCLEANBUFFERS;\r\nDBCC FREEPROCCACHE;\r\nDBCC FREESYSTEMCACHE('ALL');\r\n--\r\nSET STATISTICS IO ON; SET STATISTICS TIME ON;\r\nSELECT ET.EmpID, ET.EmpName, ET.EmpDOB, ET.EmpDOJ, ET.EmpSalary, ET.DeptID, ET.ProjID, ET.Status\r\nFROM dbo.EmployeeTbl AS ET\r\nWHERE (EXISTS (SELECT * FROM dbo.DepartmentTbl AS DT WHERE DT.DeptID=ET.DeptID AND DT.DeptID=4))\r\nUNION\r\nSELECT ET.EmpID, ET.EmpName, ET.EmpDOB, ET.EmpDOJ, ET.EmpSalary, ET.DeptID, ET.ProjID, ET.Status\r\nFROM dbo.EmployeeTbl AS ET\r\nWHERE (EXISTS (SELECT * FROM dbo.ProjectTbl AS PT WHERE PT.ProjID=ET.ProjID AND PT.ProjID=3));\r\nSET STATISTICS IO OFF; SET STATISTICS TIME OFF;\r\n--$EndRegion: Scenario #1: Performance Check --Single Query vs Union Query\r\n--\r\n--$BeginRegion: Scenario #2: Performance Check --Inner Query vs Sub Query\r\nDBCC DROPCLEANBUFFERS;\r\nDBCC FREEPROCCACHE;\r\nDBCC FREESYSTEMCACHE('ALL');\r\n--\r\nSET STATISTICS IO ON; SET STATISTICS TIME ON;\r\nSELECT DT.DeptName, PT.ProjName, COUNT(ET.EmpID) AS \"CNT\"\r\nFROM dbo.EmployeeTbl AS ET\r\nINNER JOIN dbo.DepartmentTbl AS DT ON DT.DeptID = ET.DeptID\r\nINNER JOIN dbo.ProjectTbl AS PT ON PT.ProjID = ET.ProjID\r\nGROUP BY DT.DeptName, PT.ProjName\r\nORDER BY DT.DeptName, PT.ProjName;\r\nSET STATISTICS IO OFF; SET STATISTICS TIME OFF;\r\n--\r\n--\r\nDBCC DROPCLEANBUFFERS;\r\nDBCC FREEPROCCACHE;\r\nDBCC FREESYSTEMCACHE('ALL');\r\n--\r\nSET STATISTICS IO ON; SET STATISTICS TIME ON;\r\nSELECT DT.DeptName, PT.ProjName, ET.CNT\r\nFROM (\r\n\t\t SELECT DeptID, ProjID, COUNT(EmpID) AS \"CNT\"\r\n\t\t FROM dbo.EmployeeTbl\r\n\t\t GROUP BY DeptID, ProjID\r\n\t ) AS ET\r\nINNER JOIN dbo.DepartmentTbl AS DT ON DT.DeptID = ET.DeptID\r\nINNER JOIN dbo.ProjectTbl AS PT ON PT.ProjID = ET.ProjID\r\nORDER BY DT.DeptName, PT.ProjName;\r\nSET STATISTICS IO OFF; SET STATISTICS TIME OFF;\r\n--$EndRegion: Scenario #2: Performance Check --Inner Query vs Sub Query"
}