{
  "id": "79682c35-2fe4-444a-9b4a-b126e5b3a787",
  "prefix": "Temp_MSDB_Queries",
  "description": "Temp MSDB Queries",
  "body": "--$BeginRegion: Run_Date, Run_Time to DateTime\r\nSELECT run_date,\r\n\t   SUBSTRING(CAST(run_date AS VARCHAR(8)), 1, 4) + '-' + SUBSTRING(CAST(run_date AS VARCHAR(8)), 5, 2) + '-' + SUBSTRING(CAST(run_date AS VARCHAR(8)), 7, 2) AS \"RunDate1\",\r\n\t   STUFF(STUFF(CAST(run_date AS VARCHAR(8)), 7, 0, '-'), 5, 0, '-') AS \"RunDate2\",\r\n\t   run_time,\r\n\t   SUBSTRING(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 1, 2) + ':' + SUBSTRING(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 3, 2) + ':' + SUBSTRING(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 5, 2) AS \"RunTime1\",\r\n\t   STUFF(STUFF(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 5, 0, ':'), 3, 0, ':') AS \"RunTime2\",\r\n\t   dbo.agent_datetime(run_date, run_time) AS \"DateTimeDerived\",\r\n\t   CAST(SUBSTRING(CAST(run_date AS VARCHAR(8)), 1, 4) + '-' + SUBSTRING(CAST(run_date AS VARCHAR(8)), 5, 2) + '-' + SUBSTRING(CAST(run_date AS VARCHAR(8)), 7, 2) + ' ' + SUBSTRING(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 1, 2) + ':' + SUBSTRING(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 3, 2) + ':' + SUBSTRING(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 5, 2) AS DATETIME) AS \"RunDateTime1\",\r\n\t   CAST(STUFF(STUFF(CAST(run_date AS VARCHAR(8)), 7, 0, '-'), 5, 0, '-') + ' ' + STUFF(STUFF(RIGHT('000000' + CAST(run_time AS VARCHAR(6)), 6), 5, 0, ':'), 3, 0, ':') AS DATETIME) AS \"RunDateTime2\"\r\nFROM msdb.dbo.sysjobhistory;\r\n--$EndRegion: Run_Date, Run_Time to DateTime"
}