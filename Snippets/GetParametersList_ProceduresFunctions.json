{
  "id": "7a3f5fc0-d5be-45f3-a3c5-47be9e64d7fa",
  "prefix": "GetParametersList_ProceduresFunctions",
  "description": "Get List of Parameters used in Stored Procedures and Scalar Valued User Defined Functions",
  "body": "/* =============================================================================================================================================================\r\n-- Database\t\t: USER_DATABASE\r\n-- Script\t\t: GetParametersList_ProceduresFunctions\r\n-- Description\t: Get List of Parameters used in Stored Procedures and Scalar Valued User Defined Functions\r\n-- Usage\t\t: Get List of Parameters for sys.all_objects.type IN ( 'P ', 'FN' )\r\n\t--AO.type = 'P ' => type_desc = N'SQL_STORED_PROCEDURE'\r\n\t--AO.type = 'FN' => type_desc = N'SQL_SCALAR_FUNCTION' --\r\n-- History\t\t:\r\n-- Refer Links\t: https://www.mssqltips.com/sqlservertip/1669/generate-a-parameter-list-for-all-sql-server-stored-procedures-and-functions/\r\n============================================================================================================================================================= */\r\nSELECT SCHEMA_NAME(O.schema_id) AS \"Schema\",\r\n\t   OBJECT_NAME(O.object_id) AS \"ObjectName\",\r\n\t   O.type_desc AS \"ObjectType\",\r\n\t   P.parameter_id AS \"ParamID\",\r\n\t   CASE WHEN P.parameter_id = 0 THEN 'Returns' ELSE P.name END AS \"ParameterName\", --P.parameter_id = 0 applies only for \"SQL_SCALAR_FUNCTION(FN)\"\r\n\t   TYPE_NAME(P.user_type_id) AS \"ParameterDataType\",\r\n\t   ST.name --\r\n\t\t   + CASE\r\n\t\t\t\t WHEN ST.name IN ( 'image', 'text', 'uniqueidentifier', 'date', 'time', 'datetime2', 'datetimeoffset', 'tinyint', 'smallint', 'int', 'smalldatetime', 'real', 'money', 'datetime', 'float', 'sql_variant', 'ntext', 'bit', 'smallmoney', 'bigint', 'varbinary', 'binary', 'timestamp', 'xml' ) THEN ''\r\n\t\t\t\t WHEN ST.name IN ( 'decimal', 'numeric' ) THEN '(' + CAST(P.precision AS VARCHAR(4)) + ', ' + CAST(P.scale AS VARCHAR(4)) + ')'\r\n\t\t\t\t WHEN P.max_length = -1 THEN '(max)'\r\n\t\t\t\t WHEN ST.name IN ( 'nvarchar', 'nchar' ) THEN '(' + CAST(P.max_length / 2 AS VARCHAR(5)) + ')'\r\n\t\t\t\t ELSE '(' + CAST(P.max_length AS VARCHAR(5)) + ')'\r\n\t\t\t END AS \"ConfiguredSystemType\",\r\n\t   CASE WHEN P.is_output = 1 THEN 'Output' ELSE 'Input' END AS \"Direction\"\r\nFROM sys.objects AS O\r\nINNER JOIN sys.parameters AS P --Aliasing as \"UserTypes\"\r\n\tON O.object_id = P.object_id\r\nINNER JOIN sys.types AS ST --Aliasing as \"SystemTypes\"\r\n\tON P.system_type_id = ST.user_type_id\r\nWHERE 1 = 1\r\n\tAND OBJECTPROPERTY(O.object_id, 'IsMsShipped') = 0 --Exclude MS Objects\r\n\tAND OBJECT_SCHEMA_NAME(O.object_id) <> 'sys' --To Avoid \"sys\" schema\r\n\tAND O.type IN ( 'P', 'FN' )\r\n\tAND OBJECT_NAME(O.object_id) LIKE '%$string$%';",
  "placeholders": [
    {
      "name": "string",
      "defaultValue": ""
    }
  ]
}