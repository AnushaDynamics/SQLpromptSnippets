{
  "id": "0c660065-bb61-4f4b-b08c-248ec87bbb36",
  "prefix": "DropUserCreatedStatistics",
  "description": "Drop User Created Statistics",
  "body": "DECLARE @SchemaName sysname,\r\n\t\t@TableName sysname,\r\n\t\t@UserStatsName sysname;\r\nDECLARE @SQLcmd NVARCHAR(MAX) = '';\r\n\r\nDECLARE DropUserStatsCursor CURSOR LOCAL FAST_FORWARD FOR\r\n(\r\n\tSELECT OBJECT_SCHEMA_NAME(object_id) AS SchemaName, OBJECT_NAME(object_id) AS TableName, name AS UserStatsName\r\n\tFROM sys.stats\r\n\tWHERE OBJECT_SCHEMA_NAME(object_id) <> 'sys' --To Avoid Dropping System Statistics \r\n\t\t  AND auto_created = 0 --To Avoid Dropping Auto Created Statistics\r\n\t\t  AND user_created = 1 --To Consider and Drop Only User Created Statistics\r\n);\r\n\r\nOPEN DropUserStatsCursor;\r\n\r\nFETCH NEXT FROM DropUserStatsCursor INTO @SchemaName, @TableName, @UserStatsName;\r\n\r\nWHILE @@FETCH_STATUS = 0\r\n\tBEGIN\r\n\t\tSET @SQLcmd = 'DROP STATISTICS ' + QUOTENAME(@SchemaName) + '.' + QUOTENAME(@TableName) + '.' + QUOTENAME(@UserStatsName) + ';';\r\n\t\tEXEC sys.sp_executesql @statement = @SQLcmd;\r\n\t\tFETCH NEXT FROM DropUserStatsCursor INTO @SchemaName, @TableName, @UserStatsName;\r\n\tEND;\r\n\r\nCLOSE DropUserStatsCursor;\r\nDEALLOCATE DropUserStatsCursor;"
}