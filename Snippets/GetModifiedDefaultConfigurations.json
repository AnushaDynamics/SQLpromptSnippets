{
  "id": "66614140-c03b-4747-a5ea-2e0e41d8a2d0",
  "prefix": "GetModifiedDefaultConfigurations",
  "description": "Get Modified System Configurations w.r.to Default System Configurations",
  "body": "/* =============================================================================================================================================================\r\n-- Server\t\t: LOCAL SERVER\r\n-- Script\t\t: GetModifiedDefaultConfigurations\r\n-- Description\t: Get Modified System Configurations w.r.to Default System Configurations.\r\n-- Usage\t\t: This script will check the values of your sys.configurations table and compare it to the default values. \r\n\t\t\t\t\tThe script should return a row for any configuration option that is currently set to a non-default value.\r\n-- History\t\t: The sys.configurations DoesNot Contains the Default Values as it Contains MIN and MAX values. So, This is Useful.\r\n-- Refer Links\t: http://thomaslarock.com/2014/08/sql-server-configuration-check/\r\n============================================================================================================================================================= */\r\nDECLARE @DefaultConfigurations TABLE\r\n(\r\n\tname NVARCHAR(35) NULL,\r\n\tdefault_value SQL_VARIANT NULL\r\n);\r\n\r\nINSERT INTO @DefaultConfigurations\r\n\t(\r\n\t\tname,\r\n\t\tdefault_value\r\n\t)\r\nVALUES\r\n\t('access check cache bucket count', 0),\r\n\t('access check cache quota', 0),\r\n\t('Ad Hoc Distributed Queries', 0),\r\n\t('affinity I/O mask', 0),\r\n\t('affinity64 I/O mask', 0),\r\n\t('affinity mask', 0),\r\n\t('affinity64 mask', 0),\r\n\t('Agent XPs', 1), -- Changes to 1 if SQL Agent is started, so I check for that\r\n\t('allow updates', 0),\r\n\t('awe enabled', 0),\r\n\t('backup compression default', 0),\r\n\t('blocked process threshold (s)', 0),\r\n\t('c2 audit mode', 0),\r\n\t('clr enabled', 0),\r\n\t('common criteria compliance enabled', 0),\r\n\t('contained database authentication', 0),\r\n\t('cost threshold for parallelism', 5),\r\n\t('cross db ownership chaining', 0),\r\n\t('cursor threshold', -1),\r\n\t('Database Mail XPs', 0),\r\n\t('default full-text language', 1033),\r\n\t('default language', 0),\r\n\t('default trace enabled', 1),\r\n\t('disallow results from triggers', 0),\r\n\t('EKM provider enabled', 0),\r\n\t('filestream access level', 0),\r\n\t('fill factor (%)', 0),\r\n\t('ft crawl bandwidth (max)', 100),\r\n\t('ft crawl bandwidth (min)', 0),\r\n\t('ft notify bandwidth (max)', 100),\r\n\t('ft notify bandwidth (min)', 0),\r\n\t('index create memory (KB)', 0),\r\n\t('in-doubt xact resolution', 0),\r\n\t('lightweight pooling', 0),\r\n\t('locks', 0),\r\n\t('max degree of parallelism', 0),\r\n\t('max full-text crawl range', 4),\r\n\t('max server memory (MB)', 2147483647),\r\n\t('max text repl size (B)', 65536),\r\n\t('max worker threads', 0),\r\n\t('media retention', 0),\r\n\t('min memory per query (KB)', 1024),\r\n\t('min server memory (MB)', 0),\r\n\t('nested triggers', 1),\r\n\t('network packet size (B)', 4096),\r\n\t('Ole Automation Procedures', 0),\r\n\t('open objects', 0),\r\n\t('optimize for ad hoc workloads', 0),\r\n\t('PH timeout (s)', 60),\r\n\t('precompute rank', 0),\r\n\t('priority boost', 0),\r\n\t('query governor cost limit', 0),\r\n\t('query wait (s)', -1),\r\n\t('recovery interval (min)', 0),\r\n\t('remote access', 1),\r\n\t('remote admin connections', 0),\r\n\t('remote login timeout (s)', 10),\r\n\t('remote proc trans', 0),\r\n\t('remote query timeout (s)', 600),\r\n\t('Replication XPs', 0),\r\n\t('scan for startup procs', 0),\r\n\t('server trigger recursion', 1),\r\n\t('set working set size', 0),\r\n\t('show advanced options', 0),\r\n\t('SMO and DMO XPs', 1),\r\n\t('SQL Mail XPs', 0),\r\n\t('transform noise words', 0),\r\n\t('two digit year cutoff', 2049),\r\n\t('user connections', 0),\r\n\t('user options', 0),\r\n\t('Web Assistant Procedures', 0),\r\n\t('xp_cmdshell', 0);\r\n\r\nSELECT dc.name AS \"ConfigurationName\",\r\n\t   dc.default_value,\r\n\t   sc.value_in_use\r\nFROM sys.configurations AS sc\r\nINNER JOIN @DefaultConfigurations AS dc\r\n\tON sc.name = dc.name\r\nWHERE sc.value <> sc.value_in_use\r\n\t  OR sc.value_in_use <> dc.default_value;\r\nGO"
}